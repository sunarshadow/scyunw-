<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>身份认证</title>

    <link rel="stylesheet" type="text/css" href="../css/style.css" />
        <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <style type="text/css">
    #login {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 47px;
        overflow: scroll;
        -webkit-overflow-scrolling: touch;
    }

    #login #discount .midlist .aui-list {
        padding: 0;
    }

    #login #discount .midlist .aui-list img {
        margin-top: 0;
    }
    </style>
</head>

<body>
    <input type="text" name="appDate" id="appDate" style="opacity: 0;position: fixed;z-index: -10;top: 0" />
    <div id="login">
        <div id="progressBar">
            <div id="toptitle" class="toptitle">信息填写</div>
            <button id="first" class="btn-active">1<a>信息填写</a></button>
            <div id="second_"><span></span><span></span><span></span><span></span><span></span><span></span></div>
            <button id="third">2<a>证件上传</a></button>
            <div id="third_"><span></span><span></span><span></span><span></span><span></span><span></span></div>
            <button id="fourth"><span>完成</span><a>提交验证</a></button>
        </div>
        <div class="aui-content">
            <form id="orderform">
                <div id="third_input" style="display: block">
                    <ul class="aui-list aui-form-list pad-0">
                        <li class="aui-list-item">
                            <div class="aui-list-item-inner">
                                <div class="aui-list-item-input">
                                    <div class="typename">车主姓名</div>
                                    <input id="car_name" type="text" name="car_name" placeholder="请输入姓名" value="">
                                </div>
                            </div>
                        </li>
                        <li class="aui-list-item">
                            <div class="aui-list-item-inner">
                                <div class="aui-list-item-input">
                                    <div class="typename">车牌号码</div>
                                    <input id="car_license" type="text" name="car_license" placeholder="请输入车牌号码" value="">
                                </div>
                            </div>
                        </li>
                        <li class="aui-list-item fl-fl fl-w50">
                            <div class="aui-list-item-inner">
                                <div class="aui-list-item-input">
                                    <div class="typename">手机号码</div>
                                    <input type="text" id="apply_phone" name="apply_phone" placeholder="请输入手机号" value="">
                                </div>
                            </div>
                        </li>
                        <li class="aui-list-item fl-w50 ml-20">
                            <div class="aui-list-item-inner">
                                <div class="aui-list-item-input">
                                    <div class="typename">预约时间</div>
                                    <div id="timeselect" style="font-size: 14px">请选择时间</div>
                                    <input id="awakedate" type="hidden" name="awakedate" placeholder="请选择时间">
                                    <input id="bespeaktime" type="hidden"  placeholder="请选择时间">
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div id="second_input">
                    <input id="file" type="file">
                    <div class="toptitle">身份证</div>
                    <section class="aui-grid">
                        <div class="aui-row">
                            <div class="aui-col-xs-6">
                                <div class="aui-grid-label" id="IDPicZ" onclick="getPicture('IDPicZ','people','身份证正面')">
                                    <div class="ts">
                                        <img class="from" src="../image/fromcamera.png">
                                        <div class="tsmsg">身份证正面</div>
                                    </div>
                                    <input id="IDPicZ_" type="hidden" name="id_img" value="0" data-desc='七牛云图片路径'>
                                    <input id="IDPicZ_text" type="hidden" name="id_img_text" value="0" data-desc='64位编码'>
                                    <div class="progressnum"></div>
                                </div>
                                <div class="ckexp" onclick="example('IDPicZ','idz')">
                                    查看示例
                                </div>
                            </div>
                            <!-- 身份证反面 -->
                            <div class="aui-col-xs-6">
                                <div class="aui-grid-label" id="IDPicF" onclick="getPicture('IDPicF','camera','身份证反面')">
                                    <div class="ts">
                                        <img class="from" src="../image/fromcamera.png">
                                        <div class="tsmsg">身份证反面</div>
                                    </div>
                                    <input id="IDPicF_" type="hidden" name="id_img_b" value="0" data-desc='七牛云图片路径'>
                                    <input id="IDPicF_text" type="hidden" name="id_img_b_text" value="0" data-desc='64位编码'>
                                    <div class="progressnum"></div>
                                </div>
                                <div class="ckexp" onclick="example('IDPicF','idf')">
                                    查看示例
                                </div>
                            </div>
                        </div>
                    </section>
                    <div class="toptitle">手持身份证</div>
                    <section class="aui-grid">
                        <div class="aui-row">
                            <!-- 身份证正面 -->
                            <div class="aui-col-xs-6" style="margin-left:25% ;" onclick="getPicture('IDPicS','camera','人脸识别')">
                                <div class="aui-grid-label" id="IDPicS">
                                    <div class="ts">
                                        <img class="from" src="../image/fromcamera.png">
                                        <div class="tsmsg">手持身份证</div>
                                    </div>
                                    <input id="IDPicS_" type="hidden" name="id_img_r" value="0" data-desc='七牛云图片路径'>
                                    <input id="IDPicS_text" type="hidden" name="id_img_r_text" value="0" data-desc='64位编码'>
                                    <div class="progressnum"></div>
                                    <!-- <img onclick="getPicture('IDPicS','library')" class="from" src="../image/fromlibrary.png"> -->
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </form>
        </div>
    </div>
    <div class="aui-text-center fixbottom" style="z-index: 100">
        <input type="hidden" id="orderid">
        <button type="button" id="next">下一步</button>
    </div>
    <img class="example" id="xsz" src="../image/xsz.png" alt="">  
    <img class="example" id="xsf" src="../image/xsf.png" alt="">
    <img class="example" id="idz" src="../image/idz.png" alt="">
    <img class="example" id="idf" src="../image/idf.png" alt="">
</body>

</html>
<script type="text/javascript" src="../script/jquery.min_1.11.1.js"></script>
<!-- 时间选择器 -->
<script src="../script/time/dev/js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
<script src="../script/time/dev/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
<link href="../script/time/dev/css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css" />
<link href="../script/time/dev/css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css" />
<script src="../script/time/dev/js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
<script src="../script/time/dev/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
<script src="../script/time/dev/js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
<link href="../script/time/dev/css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css" />
<!-- 时间选择器 -->
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/aui-dialog.js"></script>
<script type="text/javascript" src="../script/aui-toast.js"></script>
<script type="text/javascript" src="../script/openWin.js"></script>
<script type="text/javascript">
$(function() {
    //获取已报价未确认订单
    $.post($api.getStorage('serviceAddr') + "/api/order/getuserorder.do", {}, function(ret) {
        var json = eval("(" + ret + ")");
        for (key in json) {
            $("#" + key).val(json[key]);
        }
    }); 
});
var click_status = 0; //0，1下一步，2确认
var toast = new auiToast();
$("#next").click(function() {
    if (click_status == 0) {
        if ($("input[name='car_name']").val() == '' || $("input[name='car_license']").val() == '' || $("input[name='apply_phone']").val() == '') {
            alert("输入框不能为空,请确认输入!");
            return false;
        }
        if ($("input[name='awakedate']").val() == '') {
            alert("请先选择预约时间!");
            return false;
        }
        $("#third_input").hide();
        $("#second_input").show();
        $("#second_").addClass('div-active');
        $("#third").addClass('btn-active');
        $("#toptitle").text('证件上传');
        click_status++;
        return;
    } else if (click_status == 1) {
        if ($("#IDPicZ_text").val() == 0 || $("#IDPicF_text").val() == 0 || $("#IDPicS_text").val() == 0) {
            alert("还有证件未上传，请先上传证件!");
            return false;
        }
        $("#third_input").show().css({
            "margin-bottom": "0"
        });
        $("#fourth").addClass('btn-active');
        $("#third_").addClass('div-active');
        $("#toptitle").text('提交验证');
        click_status++;
        return;
    } else if (click_status == 2) {
        var fromary = $("#orderform").serialize();
        var id = $("#orderid").val();
        fromary += "&id=" + id + "&fktype=0";
        console.log(id);
        toast.loading({
            title: "正在验证",
            duration: 2000
        });
        $.post($api.getStorage('serviceAddr') + "/api/order/buy.do", fromary, function(ret) {
            if (ret == 1) {
                toast.hide();
                openWin('phoneauth');
            } else {
               toast.hide();
                $("#IDPicS").val(0);
                $("#IDPicS").css({
                    "background-image": "none"
                }).removeClass('active');
                alert(ret);
            }

        });
    }
});



// 时间选择器
$(function() {
    var currYear = (new Date()).getFullYear();
    var opt = {};
    opt.date = {
        preset: 'date'
    };
    opt.datetime = {
        preset: 'datetime'
    };
    opt.time = {
        preset: 'time'
    };
    opt.default = {
        theme: 'android-ics light',
        display: 'modal',
        mode: 'scroller',
        lang: 'zh',
        startYear: currYear,
        endYear: currYear + 10
    };
    $("#appDate").val('').scroller('destroy').scroller($.extend(opt['date'], opt['default']));
});

$('#timeselect').click(function() {
    $('#appDate').mobiscroll('show');
    return false;
});

</script>